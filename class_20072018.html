<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id = "divForTitle"></div>
    <h1 id="info"> ></h1>
    
    <div>
        <p>Enter Your Guess <input id="textUser" type="text"><button id="buttonGetInput"> Guess</button></p>
    </div>
    <span>
        <ul id="ulList">Your Guesses:</ul>    
    </span>
    <h2 id="end"></h2>
    
</body>

<script>
    

    
  


    /*buttonStart.addEventListener("click",((event)=>{
        var tempLi = document.createElement("li");
        tempLi.innerText = `number of submarine`;

        
        
    }));*/
    

    

    // Function finds Sizes Randomaly
    var  findRandom = ((min,max) => {
        return (max - (Math.round( Math.random() * (max-min) )))
    });
    
    

    // Function finds How much cells free in right side
    var countRightFreeCells = ((place,arr) => {
        var howMuch = 0;
        if (arr[place] ==1) 
            return (-1);
        place++;
        while (place < arr.length) {
           if (arr[place] == 0) {
            howMuch++;
            place++;
           }
           else
            return (howMuch);
        }
        return (howMuch);
    });
    
    //Function finds How much cells free in left side
    var countLeftFreeCells = ((place,arr) => {
        var howMuch = 0;
        if (arr[place] ==1) 
            return (-1);
        place--;
        while (place >= 0) {
           if (arr[place] == 0) {
            howMuch++;
            place--;
           }
           else {
               return (howMuch);
           }
        }
        return (howMuch);
    });

    //Function puts submarines randomally, according to details
    var fillOnes = (( numFreeToLeft,numFreeToRight,sizeOfSub,place,arr) => {
        arr[place] = 1;
        for (var i = place+1;(i-place<=numFreeToRight);i++) {
            if ((i - place >= sizeOfSub))
                break;
            else
                arr[i] = 1;
        }
        var cellsToContinue =  sizeOfSub - (numFreeToRight  + 1);
        while (cellsToContinue > 0) {
            arr[--place] = 1;
            cellsToContinue--;
        }
    });

    //Main:

    var arr;
    var fit = false;
    while (!fit) {
        var maxArrCell = 20;
        var minArrCell = 10;
        var rndmSizeArr = findRandom(maxArrCell,minArrCell);
        var maxNumOfSub = 3;
        var minNumOfSub = 1;
        var rndmNumOfSub = findRandom(maxNumOfSub,minNumOfSub);
        var maxSubSize = 4;
        var minSubSize = 2;
        var rndmSubSize = findRandom(maxSubSize,minSubSize);
        if (rndmSizeArr >= (rndmNumOfSub*rndmSubSize)) {
            fit = true;
            arr = new Array(rndmSizeArr);
        }
    }

    
    arr.fill(0);
    var count = 0;
    //puting submarines randomally
    while (count < rndmNumOfSub) {
        place = Math.round(Math.random() * (rndmSizeArr-1));
        var numFreeToLeft = countLeftFreeCells(place,arr);
        var numFreeToRight = countRightFreeCells(place,arr);
        if (numFreeToLeft + numFreeToRight >= (rndmSubSize - 1)) {
            fillOnes(numFreeToLeft,numFreeToRight,rndmSubSize,place,arr);
            count++;
        }
    } 
    
    //interacting with user

    var buttonStart = document.querySelector("btnStart");
    var ul = document.createElement("ul");
    document.body.appendChild(ul);
    var divTitle = document.querySelector("#divForTitle");
    var title1 = document.querySelector("#info");
    var end = document.getElementById("end");

    
    var times = 13;
    var guessNumber = 1;
    var userInput;
    var li;
    var info = `you have ${times} times to guess where are the  ${rndmNumOfSub} submarines, sized:  ${rndmSubSize}  in array with  ${rndmSizeArr} cells`;
    
    title1.innerHTML = info ;
    divTitle.appendChild(title1);
    var textInput;
    var buttonUser;

    function func() {
        textInput = document.getElementById("textUser").value;
       // textinput += "jjjjkj";
        li = document.createElement("li");
        li.appendChild(document.createTextNode(textInput));
        
        
       // ul.appendChild(<li>fdwfdw</li>);
        
        //console.log(parseInt(textInput));
        if ((parseInt(textInput) >=0)  && (parseInt(textInput) < arr.length)) {
            if(arr[parseInt(textInput)] == 1)
            {
                arr[parseInt(textInput)] = 2;
                li.innerHTML += " HIT!"
                ul.appendChild(li);
                times--;
            }
            else {
                li.innerHTML += " MISSED!"
                ul.appendChild(li);
                times--;

            }
        }
        else 
            document.getElementById("textUser").value =  "illegal input.try again";
        
        if (arr.includes(1) == false) {
            buttonUser.removeEventListener("click",func);
            end.innerHTML = "End Of The Game, You WON";
            document.body.appendChild(end);
            
        }
        if (times == 0) {
            buttonUser.removeEventListener("click",func);
            end.innerHTML = "End Of The Game, You LOOSE";
            document.body.appendChild(end);
            return;
        }
    }
    
    
    buttonUser = document.getElementById("buttonGetInput");
    buttonUser.addEventListener("click",func);
        
        
        
    //};
    //if (arr.includes(1)) {
      //  alert ("you failed to hit all the submarines")
      //  console.log("array after user input "+arr); 
  //  }
    
    
    
    
       

  



    

    
    
   
   


    
    

    /*while (numOfSubmarines > 0) {
        var rndm = ((maxArrayCell - Math.floor(MATH.random() * (maxArrayCell-minArrayCell)))-1 );
        if (rndm = 0 && (array[rndm+1] ==0) )
            array.splice(0,2,1);
        else if (rndm = (MATH.max(firstCell,maxArrayCell)-1) && (array[rndm-1] == 0))
            array.splice((maxArrayCell-2),2,1);
        
        
        numOfSubmarines--;
    }
    // what we did in the start
    var hitCounter = 0;
    var submarineLength = submarine.reduce((a,b)=>a+b);
    var answer ; 
    while (hitCounter < submarineLength) {
        answer = prompt("please enter your hit");
        if ((answer >= 1) && (answer <= submarine.length))  {
            if (submarine[answer-1] == 1) {
                hitCounter++;
                submarine[answer-1] = 2;
                alert("you hit the target");
                
            }    
            else
                alert("you missed  the target");
        }
        
    } */



</script>
</html>